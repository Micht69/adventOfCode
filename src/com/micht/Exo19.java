package com.micht;

import org.junit.Assert;
import org.junit.Test;

public class Exo19 {

	private static final String[] INPUT = new String[] {
			"                                                               |                                                                                                                                         ",
			"       +-------------------------------------------------------|-----------------------------+ +-------+ +-------+           +-+   +-------------------------------------------------------------+       ",
			"       |                                                       |                             | |       | |       |           | |   |                                                             |       ",
			"       |     +-------+                     +---------------+   |                     +-------|---------|-+       |         +-|-----------------------------------------+                         |       ",
			"       |     |       |                     |               |   |                     |       | |       |         |         | | |   |                                   |                         |       ",
			"       |     |       +---------------------|-----------------------------------------|-------|-----+   |         |         | +-|---+                         +-----------------------------------------+ ",
			"       |     |                             |               |   |                     |       | |   |   |         |         |   |                             |         |                         |     | ",
			"       |     | +---------------------------|---+ +-------+ +---|---+               +-|-------|-------------------------------+ |                             |         |                     +-+ |     | ",
			"       |     | |                           |   | |       |     |   |               | |       | |   |   |         |         | | |                             |         |                     | | |     | ",
			"   +---------|---------------------------------|---------|---------|---------------|---------------|---|-------------------|-|-------------------------------|-------+ |                     | | |     | ",
			"   |   |     | |                           |   | |       |     |   |               | |       | |   |   |         |         | | |                             |       | |                     | | |     | ",
			"   |   +-----|-------------------------------------------------|---|---------------------------|-------|-------------------------------------------------------------------------------+     | | |     | ",
			"   |         | |                           |   | |       |     |   |               | |       | |   |   |         |         | | |                             |       | |               |     | | |     | ",
			"   |         | |                           |   +---------|-----|---+               | |       | | +-----+         |     +---|-+ +-----------------------------|---------|---------------|-----|-----+   | ",
			"   |         | |                           |     |       |     |                   | |       | | | |             |     |   |                                 |       | |               |     | | | |   | ",
			"   |         | |                           |   +-+ +-----------|-----------+       | |       | | +-------------+ |     |   |                     +-------------------+ |               | +-----|---|---+ ",
			"   |         | |                           |   |   |     |     |           |       | |       | |   |           | |     |   |                     |           |         |               | |   | | | |     ",
			"   |         | |                       +-------|---|-----------|-----------|-------------------|---|-------------|-------------------------------|-----------|---------|---------------+ |   | | | |     ",
			"   |         | |                       |   |   |   |     |     |           |       | |       | |   |           | |     |   |                     |           |         |                 |   | | | |     ",
			"   |         | |                       |   |   |   +-----|-----------------|-----------------|-+   |           | |     |   |                     |           |         |                 |   | | | |     ",
			"   |         | |                       |   |   |         |     |           |       | |       |     |           | |     |   |                     |           |         |                 |   | | | |     ",
			"   |         | |                       |   |   |         |   +-+           |       | |       |     |           | |     |   |                     |           |         |                 |   | | | |     ",
			"   |         | |                       |   |   |         |   |             |       | |       |     |           | |     |   |                     |           |         |                 |   | | | |     ",
			"   |         | |                       |   |   |         |   |             |       | |       |     |           | |     |   |                     |           |         |   +-+           |   | | | |     ",
			"   |         | |                       |   |   |         |   |             |       | |       |     |           | |     |   |                     |           |         |   | |           |   | | | |     ",
			"   |         | |                       |   |   |         |   |             |       | |       |     |           | |     |   |   +-----------------|-----------|-----+   |   | |           |   | | | |     ",
			"   |         | |                       |   |   |         |   |             |       | |       |     |           | |     |   |   |                 |           |     |   |   | |           |   | | | |     ",
			"   +-+ +-------------------------------+   |   +---------|-----------------|-------|---------------------------|---------------|-------+         |           |     |   |   | |           |   | | | |     ",
			"     | |     | |                           |             |   |             |       | |       |     |           | |     |   |   |       |         |           |     |   |   | |           |   | | | |     ",
			"   +-|-|---+ | |         +---------------+ |   +-------------|-------------|---------+       |     |   +---------|---------|---|---------------+ |           |     |   |   | |     +-----|-------------+ ",
			"   | | |   | | |         |               | |   |         |   |             |       |         |     |   |       | |     |   |   |       |       | |           |     |   |   | |     |     |   | | | |   | ",
			" +-+ | |   +---------------------+       | |   | +-------------------------|-----------------+     |   |       | |     |   |   |       |       | |           |     |   |   | |     |     +---+ | | |   | ",
			" |   | |     | |         |       |       | |   | |       |   |             |       |               |   |       | |     |   |   |       |       | |           |     |   |   | |     |           | | |   | ",
			" | +-|-|-----------------|-----------------|---|-|-------|---|---------------------|---------------|---|-------|---------------------------------|-------------------+ |   | |     |           | | |   | ",
			" | | | |     | |         |       |       | |   | |       |   |             |       |               |   |       | |     |   |   |       |       | |           |     | | |   | |     |           | | |   | ",
			" | | | |     | |         |       |       | |   | +---------------------------------|-------+       |   |       | |     |   |   |       |       | |           |     | | |   | |     +-----------+ | |   | ",
			" | | | |     | |         |       |       | |   |         |   |             |       |       |       |   |       | |     |   |   |       |       | |           |     | | |   | |                   | |   | ",
			" | | | |     | |         |       |       | |   |         |   |             |       |       |   +---|-----------|-|-----+   |   |       +-------|-------------------+ | |   | |                   | |   | ",
			" | | | |     | |         |       |       | |   |         |   |             |       |       |   |   |   |       | |         |   |               | |           |       | |   | |                   | |   | ",
			" +-|-----+   | |         |     +-|-------|-----|-------------|-------------|---------------------------|-------|-----------|---|---------------|-|-----------------+ | |   | |                   | |   | ",
			"   | | | |   | |         |     | |       | |   |         |   |             |       |       |   |   |   |       | |         |   |               | |           |     | | |   | |                   | |   | ",
			" +-------+ +-|-|---+     |     | |       | |   |         |   |             |       |       |   |   |   |   +---|---------------|---------------|---------------+   | | |   | |                   | |   | ",
			" | | | |   | | |   |     |     | |       | |   |         |   |             |       |       |   |   |   |   |   | |         |   |               | |           | |   | | |   | |                   | |   | ",
			" | +-|-|-+ | | |   |     |     | +-------|-|---|-------+ |   |             |       |       |   |   |   |   |   | |         |   |               | |           | |   | | |   | |                   | |   | ",
			" |   | | | | | |   |     |     |         | |   |       | |   |             |       |       |   |   |   |   |   | |         |   |               | |           | |   | | |   | |                   | |   | ",
			" | +---|---|-|-+ +-------|-----|-----------|---|-------------|-------------|---------------|-----------|-------|-|-------------|-----------+   | | +-------------------|-----|-+                 | |   | ",
			" | | | | | | |   | |     |     |         | |   |       | |   |             |       |       |   |   |   |   |   | |         |   |           |   | | |         | |   | | |   | | |                 | |   | ",
			" | +-+ | | +-|-----|-----------|---------|-|---|-------+ |   |       +---------+   |       |   |   |   |   |   | |         |   +-----------|-----|-----------------|-----------|-+               | |   | ",
			" |     | |   |   | |     |     |         | |   |         |   |       |     |   |   |       |   |   |   |   |   | |         |               |   | | |         | |   | | |   | | | |               | |   | ",
			" |     | | +-----|-------------|---------|-----|---------------------------|-----------------------|-------|-----------------------------+ |   | | |         | |   | | |   | | | |               | |   | ",
			" |     | | | |   | |     |     |         | |   |         |   |       |     |   |   |       |   |   |   |   |   | |         |             | |   | | |         | |   | | |   | | | |               | |   | ",
			" |     | | | |   | |     |     |         | |   +---------|---|-------+     |   |   |       |   |   |   |   |   | |         |             | |   | | |     +---+ |   | | |   | | | |               | |   | ",
			" |     | | | |   | |     |     |         | |             |   |             |   |   |       |   |   |   |   |   | |         |             | |   | | |     |     |   | | |   | | | |               | |   | ",
			" +---+ | | | +---|-|-----|-----|-------------------------|---|-------------|-------|-------|-------|---|-------|-|---------|-------------|-|---|---|---+ |     |   | | |   | | | |               | |   | ",
			"     | | | |     | |     |     |         | |             |   |             |   |   |       |   |   |   |   |   | |         |             | |   | | |   | |     |   | | |   | | | |               | |   | ",
			"     | | | |     | |     |     |         | |             | +---------------|---|-------------------|-----------+ |         |             | |   | | |   | |     |   | | |   | | | |       +---+   | |   | ",
			"     | | | |     | |     |     |         | |             | | |             |   |   |       |   |   |   |   |     |         |             | |   | | |   | |     |   | | |   | | | |       |   |   | |   | ",
			"     | | | |   +---------|-----|---------|-----------------|-|---------+   |   |   |       |   |   |   |   |     |         |             | |   | | |   | |     |   | | |   | | | |       |   |   | |   | ",
			"     | | | |   | | |     |     |         | |             | | |         |   |   |   |       |   |   |   |   |     |         |             | |   | | |   | |     |   | | |   | | | |       |   |   | |   | ",
			"     | | | |   +-|-|-----------|---------|---------------+ +-|---+ +-------+   |   |       |   |   |   |   |     |         |             | |   | | |   | |     |   | | |   | | | |       |   |   | |   | ",
			"     | | | |     | |     |     |         | |                 |   | |   |       |   |       |   |   |   |   |     |         |             | |   | | |   | |     |   | | |   | | | |       |   |   | |   | ",
			"     | | | |     | |     |     |         | |                 |   | |   |     +-------------|-------|---|---------|---------|-------------|-|---|-|-|-----------|---|-------+ | | +-------|---|---|-|---+ ",
			"     | | | |     | |     |     |         | |                 |   | |   |     | |   |       |   |   |   |   |     |         |             | |   | | |   | |     |   | | |     | |         |   |   | |     ",
			"     | | | |     | |     |     |         | |                 |   | |   |     | |   |       |   |   |   +-----------------------------------|---|-|---------------+ | | |     | |         |   |   | |     ",
			"     | | | |     | |     |     |         | |                 |   | |   |     | |   |       |   |   |       |     |         |             | |   | | |   | |     | | | | |     | |         |   |   | |     ",
			"     | | | |   +-|-|-----------|-------+ | |                 |   | | +-|-----|-----------------|---|-------|-----|---------|-------------|-|---|---|---|-----------|-|-|-----|-------------+ |   | |     ",
			"     | | | |   | | |     |     |       | | |                 |   | | | |     | |   |       |   |   |       |     |         |             | |   | | |   | |     | | | | |     | |         | | |   | |     ",
			"     | | | |   | | |     |     |       | | |                 |   | | | | +-------+ |       |   |   |       |     |         |             | |   | | |   | |     | | +---|-----|-|---+     | | |   | |     ",
			"     | | | |   | | |     |     |       | | |                 |   | | | | |   | | | |       |   |   |       |     |         |             | |   | | |   | |     | |   | |     | |   |     | | |   | |     ",
			"     | | | |   | | |     |     |       | | |                 | +---+ +---|---|---|---------|---+   |       |     |         |             | |   | | |   | |     | |   | |     | |   |     | | |   | |     ",
			"     | | | |   | | |     |     |       | | |                 | | |     | |   | | | |       |       |       |     |         |             | |   | | |   | |     | |   | |     | |   |     | | |   | |     ",
			"     | | | |   | | |   +-|-----------------|-----------------|-|-----+ | |   | | | |       |       |       |     |         |             | |   | | |   | |     | |   | |     | |   |     | | |   | |     ",
			"     | | | |   | | |   | |     |       | | |                 | | |   | | |   | | | |       |       |       |     |         |             | |   | | |   | |     | |   | |     | |   |     | | |   | |     ",
			"     | | | |   | | |   +-|-------+     +---|-----------------|---|-+ | | |   | | | | +-----|-------|-------------|---------|-------------|-|-----|-|-----|---+ | |   | |     | |   |     | | |   | |     ",
			"     | | | |   | | |     |     | |       | |                 | | | | | | |   | | | | |     |       |       |     |         |             | |   | | |   | |   | | |   | |     | |   |     | | |   | |     ",
			"     | | | | +-|---|-------------------+ | |             +-------+ | | | |   | | | | | +---|---------------------|---------|-------------|-|---|---|---+ |   | | |   | |     | |   |     | | |   | |     ",
			"     | | | | | | | |     |     | |     | | |             |   | |   | | | |   | | | | | |   |       |       |     |         |             | |   | | |     |   | | |   | |     | |   |     | | |   | |     ",
			"     | | | | | | | |   +-+     | |   +-|---|-------------|---|-----|-|-|-|---|-|---|-|-|---|-------+       |     |         |             | |   | | |     |   | | |   | |     | |   |     | | |   | |     ",
			"     | | | | | | | |   |       | |   | | | |             |   | |   | | | |   | | | | | |   |               |     |         |             | |   | | |     |   | | |   | |     | |   |     | | |   | |     ",
			"     | | | | | | | |   +---------|-------|-|-------------|-----+   | | | |   | | | | | |   |               |     |         |             | |   | | |     |   | | |   | |     | |   |     | | |   | |     ",
			"     | | | | | | | |           | |   | | | |             |   |     | | | |   | | | | | |   |               |     |         |             | |   | | |     |   | | |   | |     | |   |     | | |   | |     ",
			"     | | | | | | | |           | |   | | | |             |   |     | | +-|-------|-|-----------------------|---+ |         |       +---------------|---------|-|-|-----------|-----|-----|-|-|-----|---+ ",
			"     | | | | | | | |           | |   | | | |             |   |     | |   |   | | | | | |   |               |   | |         |       |     | |   | | |     |   | | |   | |     | |   |     | | |   | |   | ",
			"   +-|---------|-|-------------------|-----|-------------|---|-----|-|---|-----|-|-----|-------------------|---|-|---------|-------------------|-|-+     |   +---------|-------|-+ |     | | |   | |   | ",
			"   | | | | | | | | |           | |   | | | |             |   |     | |   |   | | | | | |   |               |   | |         |       |     | |   | |       |     | |   | |     | | | |     | | |   | |   | ",
			"   | | | | | | | | |           | |   | | | |             |   |     | | +-----|---|-|-----+ |               |   | |         |       |     | |   | |       |     | |   | | +-----|-+ |     | | |   | |   | ",
			"   | | | | | | | | |           | |   | | | |             |   |     | | | |   | | | | | | | |               |   | |         |       |     | |   | |       |     | |   | | |   | |   |     | | |   | |   | ",
			"   | | | | | | | | |           | |   | | | |             |   |     | | | |   | | | +---|-|-|---------------------------------------------------|-----------+   | |   | | |   | |   |     | | |   | |   | ",
			"   | | | | | | | | |           | |   | | | |             |   |     | | | |   | | |   | | | |               |   | |         |       |     | |   | |       | |   | |   | | |   | |   |     | | |   | |   | ",
			"   | | | | | | | | |           | |   | | | |             |   |     | | | |   | | |   | | | |               |   | |         |       |     | |   | | +-+   | |   | |   | | |   | |   |     | | |   | |   | ",
			"   | | | | | | | | |           | |   | | | |             |   |     | | | |   | | |   | | | |               |   | |         |       |     | |   | | | |   | |   | |   | | |   | |   |     | | |   | |   | ",
			"   | | | | | | | | |   +---------|---|-|-|-+             |   |     | | | |   | | |   | | | |               |   | |         |       |     | |   | | | |   | |   | |   | | |   | |   |     | | |   | |   | ",
			"   | | | | | | | | |   |       | |   | | |               |   |     | | | |   | | |   | | | |               |   | |         |       |     | |   | | | |   | |   | |   | | |   | |   |     | | |   | |   | ",
			"   | | | | | | +---|---|-------------|-|---------------------|-------|-|-|---|---|---|---------------------|---|-----------|-------|-----|-|-----|-+ |   +-|-+ | |   | | |   | |   |     | | |   | |   | ",
			"   | | | | | |   | |   |       | |   | | |               |   |     | | | |   | | |   | | | |               |   | |         |       |     | |   | |   |     | | | |   | | |   | |   |     | | |   | |   | ",
			"   | | | | | |   | | +-------+ +-----|-|-----------------------+   | | | |   | | |   | | | |               |   | +---------|-------------|-----|-|-----------|---|-+ | | |   | |   |     | | | +-----+ | ",
			"   | | | | | |   | | | |     |   A   | | |               |   | |   | | | |   | | |   | | | |               |   |           |       |     | |   | |   |     | | | | | | | |   | |   |     | | | | | | | | ",
			"   | | | | | |   | | | |     |   |   +-|-----------------|-----|-------|-|-------|---|-|---|-------------------|-----------|-------|-----|-----------|-------|-----|-|-|-----|-----------|---------|-+ | ",
			"   | | | | | |   | | | |     |   |     | |               |   | |   | | | |   | | |   | | | |               |   |           |       |     | |   | |   |     | | | | | | | |   | |   |     | | | | | |   | ",
			"   | | | | | |   +-|---------|---|-------|-------------------|---------|-|---|-|-----|---+ |               |   |           |       |     | |   | | +-------|-+ | | | | | |   | |   |     | | | | | |   | ",
			"   | | | | | |     | | |     |   |     | |               |   | |   | | | |   | | |   | |   |               |   |           |       |     | |   | | | |     |   | | | | | |   | |   |     | | | | | |   | ",
			"   | | | | | |     | | |     |   |     | |               |   | |   | | | |   | | |   | |   |               | +-|---------------------------|-------|-|-----+ +-----+ | | |   | | +-------|-----|-|-|-+ | ",
			"   | | | | | |     | | |     |   |     | |               |   | |   | | | |   | | |   | |   |               | | |           |       |     | |   | | | |       | | |   | | |   | | | |     | | | | | | | | ",
			"   | | | | | |     | +-|-+   +---------|-|-------------------|-|---|---|-|---|---------|---------------------|-------------|-------|-----|-------|-|---------+ | |   | | |   | | | |     | | | | | | | | ",
			"   | | | | | |     |   | |       |     | |               |   | |   | | | |   | | |   | |   |               | | |           |       |     | |   | | | |         | |   | | |   | | | |     | | | | | | | | ",
			"   | | | | | |     |   | |       |     | |               |   | |   | | | |   | | |   | |   |               | | |           |       |     | |   | | | |   +-------|---|-----+ | | | |     | | | | | | | | ",
			"   | | | | | |     |   | |       |     | |               |   | |   | | | |   | | |   | |   |               | | |           |       |     | |   | | | |   |     | |   | | | | | | | |     | | | | | X | | ",
			"   | | | | | |     |   | |       |     | |               |   | |   | | | |   | | |   | |   | +---------------|-|-------------------|-----------|---+ |   |     | |   | | | | | | | |     | | | | | | | | ",
			"   | | | | | |     |   | |       |     | |               |   | |   | | | |   | | |   | |   | |             | | |           |       |     | |   | |   |   |     | |   | | | | | | | |     | | | | | | | | ",
			"   | | | | | |     |   | |       |     | |               +---|-|-----|---|-----------|-|-------------------------------------------|-------------|-------------|-----|-|-+ | | | | |     | | | | | | | | ",
			"   | | | | | |     |   | |       |     | |                   | |   | | | |   | | |   | |   | |             | | |           |       |     | |   | |   |   |     | |   | |   | | | | |     | | | | | | | | ",
			" +-|---------|-----------------+ |     | |                   | |   | | | |   | | |   | |   | |             | | |           |       |     | |   | |   |   |     | |   | |   | | | | |     | | | | | | | | ",
			" | | | | | | |     |   | |     | |     | |                   | |   | | | |   | | |   | |   | |             | | |           |       |     | |   | |   |   |     | |   | |   | | | | |     | | | | | | | | ",
			" | | | | | | |     |   | |     | |     | |                   | |   | | | |   | | |   | |   | |             | | | +---------|-------|-----|-|-+ | |   |   |     | |   | |   | | | | |     | | | | | | | | ",
			" | | | | | | |     |   | |     | |     | |                   | |   | | | |   | | |   | |   | |             | | | |         |       |     | | | | |   |   |     | |   | |   | | | | |     | | | | | | | | ",
			" | | | | | | |     |   | |     | |     | |                   | |   | | | |   | | |   | |   | |             | | | |         |     +-|-------|---|-----|---|-----------|-----+ | | | |     | | | | | | | | ",
			" | | | | | | |     |   | |     | |     | |                   | |   | | | |   | | |   | |   | |             | | | |         |     | |     | | | | |   |   |     | |   | |     | | | |     | | | | | | | | ",
			" | | | +-----------|---|-|-----|-|-----|---------------------------|-|-|-|---|-|-|---|-------|-----------------|-|---------|-----|-------+ | | | |   |   |   +-------|-----+ | | | |     | | | | | | | | ",
			" | | |   | | |     |   | |     | |     | |                   | |   | | | |   | | |   | |   | |             | | | |         |     | |       | | | |   |   |   | | |   | |   | | | | |     | | | | | | | | ",
			" +-------|-|---------------------|---------------------------------|-----|---|-|-----|-----|-+             | | | |         |     | |     +---|-+ +---+   |   | +-|---|-----|---|---|-+   | | | | | | | | ",
			"   | |   | | |     |   | |     | |     | |                   | |   | | | |   | | |   | |   |               | | | |         |     | |     | | |           |   |   |   | |   | | | | | |   | | | | | | | | ",
			"   | |   | | |     |   | |     | |     | | +-+           +---|-|---+ | | | +-|---+   | |   |               | | | |         |     | |     | | |         +-|---|---|---------|---|-----+   | | | | | | | | ",
			"   | |   | | |     |   | |     | |     | | | |           |   | |     | | | | | |     | |   |               | | | |         |     | |     | | |         | |   |   |   | |   | | | | |     | | | | | | | | ",
			"   +-|-----|-|-----|---|-|-------------|-|-------------+ |   | |     | | | | | |     | |   |   +-----------|-|-------------|-----------------|---------|-|-------|---|-----|-+ | | +-+   | | | | | | | | ",
			"     |   | | |     |   | |     | |     | | | |         | |   | |     | | | | | |     | |   |   |           | | | |         |     | |     | | |         | |   |   |   | |   |   | |   |   | | | | | | | | ",
			"     |   | | |     |   | |   +-|-------+ | | |         | |   | |     | | | | | +-----|-|-------|-----------|-|-------------------|-|-------|-----------+ |   |   |   | |   |   | |   |   | | | | | | | | ",
			"     |   | | |     |   | |   | | |       | | |         | |   | |     | | | | |       | |   |   |           | | | |         |     | |     | | |           |   |   |   | |   |   | |   |   | | | | | | | | ",
			" +-+ |   +---------|-----|---|-----------|---|-----------|---|-|-----------|-|-------|---------|-----+     | | | |         |     | |     | | |           |   |   +---|-|---|---------+   | | | | | | | | ",
			" | | |     | |     |   | |   | | |       | | |         | |   | |     | | | | |       | |   |   |     |     | | | |         |     | |     | | |           |   |       | |   |   | |       | | | | | | | | ",
			" +---|-----|-----+ |   | |   | | |       | | |         | |   | |     | | | | +-------|-------------+ |     | | | |         |     | |     | | |           |   |       | |   |   | |       | | | | | | | | ",
			"   | |     | |   | |   | |   | | |       | | |         | |   | |     | | | |         | |   |   |   | |     | | | |         |     | |     | | |           |   |       | |   |   | |       | | | | | | | | ",
			" +---|-----------------|-----|-|-----------|-----------|-|---|-------|---|-|---------|-|-----------|-------------|---------------|-|-----|-|-------------|-----------+ |   |   | |       | | | | | | | | ",
			" | | |     | |   | |   | |   | | |       | | |         | |   | |     | | | |         | |   |   |   | |     | | | |         |     | |     | | |           |   |         |   |   | |       | | | | | | | | ",
			" | | |     | |   | |   | |   | | |       | | |         | |   +-------|-+ | |         | +---|---------+     | | | |         |     | |     | | |         +-|-----------------------|-----------|---|---+ | ",
			" | | |     | |   | |   | |   | | |       | | |         | |     |     |   | |         |     |   |   |       | | | |         |     | |     | | |         | |   |         |   |   | |       | | | | | |   | ",
			" +-|-|-------|-----|---|-----|---|-------|-|-----------|-------------|---|-----------------|---------------|-|-|-----+     |     | |     | +-----------|-+   |         | +-|---------+   | | | | | |   | ",
			"   | |     | |   | |   | |   | | |       | | |         | |     |     |   | |         |     |   |   |       | | | |   |     |     | |     |   |         |     |         | | |   | |   |   | | | | | |   | ",
			"   | |   +-|-----|-----+ |   | | |       | | |         | |     |     |   | |       +-|-------------|------------Z|---|-----------------------+         |     |         | | |   | |   |   | | | | | |   | ",
			"   | |   | | |   | |     |   | | |       | | |         | |     |     |   | |       | |     |   |   |       | | | |   |     |     | |     |             |     |         | | |   | |   |   | | | | | |   | ",
			"   | |   | | |   | |     | +-+ | +-----------------------------|-----|-----|---------------|---|---------------|-----+     |     | +-------------------|-----------------|-|---|-|-------|-|-+ | | |   | ",
			"   | |   | | |   | |     | |   |         | | |         | |     |     |   | |       | |     |   |   |       | | | |         |     |       |             |     |         | | |   | |   |   | |   | | |   | ",
			" +-|-+   | | |   | |     | |   | +---------------------+ |     |     |   | |       | |     |   +---|-------|-|-------------|-------------|-------------|-----|-------------|-----|-----+ | |   | | |   | ",
			" | |     | | |   | |     | |   | |       | | |           |     |     |   | |       | |     |       |       | | | |         |     |       |             |     |         | | |   | |   | | | |   | | |   | ",
			" | |     | | |   | |     | |   | |   +---|-+ |           |     |     |   | |       | |     |       |       | | | |         |     |       |             |     |         | | |   | |   | | | |   | | |   | ",
			" | |     | | |   | |     | |   | |   |   |   |           |     |     |   | |       | |     |       |       | | | |         |     |       |             |     |         | | |   | |   | | | |   | | |   | ",
			" | |     | | |   | |     | |   | |   |   |   |           |     |     +---|---------|-|-------------|---------|-|-|-------------------------------------|-----|---+     | | |   | +-----|-------+ | |   | ",
			" | |     | | |   | |     | |   | |   |   |   |           |     |         | |       | |     |       |       | | | |         |     |       |             |     |   |     | | |   |     | | | |     | |   | ",
			" | |     | | |   | |     | |   | |   |   |   |           |     |         | |       | |     |       |       | | | |         |     |       |             |     |   |     +-------|-----+ +-------+ | |   | ",
			" | |     | | |   | |     | |   | |   |   |   |           |     |         | |       | |     |       |       | | | |         |     |       |             |     |   |       | |   |         | |   | | |   | ",
			" | |     | | |   | |     | |   | |   |   |   |           |     |         | |       | |     |       |       | | | |         |     |       |             |     |   |       | |   |         | |   | | |   | ",
			" | |     | | |   | |     | |   | |   |   |   |           |     |         | |       | |     |       |       | | | |         |     |       |             |     |   |       | |   |         | |   | | |   | ",
			" | |     | | |   | |     | |   | |   |   |   |           |     |         | |       | |     |       |       | | | |         |     |       |             |     |   |       | |   |         | |   | | |   | ",
			" | |     | | |   | |     | |   | |   |   |   |           |     |         | |       | |     |       |       | | | |         |     |       |             |     |   |       | |   |         | |   | | |   | ",
			" | +-----+ | |   | |     | +---|-----|-------|---------------------------|-+       | |     |       |       | | | |         |     |       |             |     |   |       | |   |         | |   | | |   | ",
			" |         | |   | |     |     | |   |   |   |           |     |         |         | |     |       |       | | | |         |     |       |             |     |   |       | |   |         | |   | | |   | ",
			" | +---------|-----|-----|-----|-+   |   |   |           |     +---------------------------|-------|-------|-|-|-----+     |     |       |             |     |   |       | |   |         | |   | | |   | ",
			" | |       | |   | |     |     |     |   |   |           |               |         | |     |       |       | | | |   |     |     |       |             |     |   |       | |   |         | |   | | |   | ",
			" | |       | |   | |     |     |     |   |   |           |               |         | |     |       |       | | | |   |     |     |       +-------------|--I--------+     | |   |         | |   | | |   | ",
			" | |       | |   | |     |     |     |   |   |           |               |         | |     |       |       | | | |   |     |     |                     |     |   | |     | |   |         | |   | | |   | ",
			" | |       | |   | |     |     |     |   |   |         +-----------------+         | |     |       |       | | | |   |     |     |                     |     |   | |     | |   |         | |   | | |   | ",
			" | |       | |   | |     |     |     |   |   |         | |                         | |     |       |       | | | |   |     |     |                     |     |   | |     | |   |         | |   | | |   | ",
			" | |       | |   | |     | +---|-------------------------|---------------------------|-----|---+   |       | | | |   |     |     |                     |     |   | |     | +-+ |     +-+ | |   | | |   | ",
			" | |       | |   | |     | |   |     |   |   |         | |                         | |     |   |   |       | | | |   |     |     |                     |     |   | |     |   | |     | | | |   | | |   | ",
			" | |       | |   | |     | |   |     |   | +-|---------|-|---------------------------|-----|---+   |       | | | |   |     |     |                     |     |   +-----------|-|-----+ | | |   | | |   | ",
			" | |       | |   | |     | |   |     |   | | |         | |                         | |     |       |       | | | |   |     |     |                     |     |     |     |   | |       | | |   | | |   | ",
			" +-|-------------|---------|---------|---|-|-|---------|-|---------------------------------|-------|-------|-|-------------------------------------+ +-|-----|---------------|-|---+   | | |   | | |   | ",
			"   |       | |   | |     | |   |     |   | | |         | |                         | |     |       |       | | | |   |     |     |                 | | |     |     |     |   | |   |   | | |   | | |   | ",
			"   |       | |   | |     | |   |     |   +---+         | +---------------------------------|---------------|-----------------------------------+   +-|-----------------------------+   | | |   | | |   | ",
			"   |       | |   | |     | |   |     |     |           |                           | |     |       |       | | | |   |     |     |             |     | |     |     |     |   | |       | | |   | | |   | ",
			"   |       | +-+ +-------------------|-----|---------------+                       | |     |   +---|-------|-|---|---|-----------|-------------|-----|-+     |   +-+     |   | |       | | |   | | |   | ",
			"   |       |   |   |     | |   |     |     |           |   |                       | |     |   |   |       | | | |   |     |     |             |     |       |   |       |   | |       | | |   | | |   | ",
			"   |       |   |   +-----+ +---------|-----------------|---|-----------------------+ |     |   |   +-----------|-|---|-------------------------------|-------|-----------|-------------+ | |   | | |   | ",
			"   |       |   |               |     |     |           |   |                         |     |   |           | | | |   |     |     |             |     |       |   |       |   | |         | |   | | |   | ",
			"   +-------|---|---------------------------|---------------------------------------------------|---------------|-|---|-----------|-------------+     |       |   |       |   | |         | |   | | |   | ",
			"           |   |               |     |     |           |   |                         |     |   |           | | | |   |     |     |                   |       |   |       |   | |         | |   | | |   | ",
			"           +-------------------|-----|-----|---------------|-----------------------------------|-------------|-------------------|-------------------|-------|---------------|-|---------|-----|-+ |   | ",
			"               |               |     |     |           |   |                         |     |   |           | | | |   |     |     |                   |       |   |       |   | |         | |   |   |   | ",
			"               |         +-----------------|-----------+   |                         |     |   |           | | | |   |     |     |                   +-------|---|-----------------+     | |   |   |   | ",
			"               |         |     |     |     |               |                         |     |   |           | | | |   |     |     |                           |   |       |   | |   |     | |   |   |   | ",
			"               |         +-----------|U----|---------------+                         |     |   |           | | | |   |     |     |                           |   |       +-----|---|-------|---|-------+ ",
			"               |               |     |     |                                         |     |   |           | | | |   |     |     |                           |   |           | |   |     | |   |   |     ",
			"             +-|---------------------|-----------------------------------------------|-+   |   |           | | | |   |     |     |                           |   |           | |   |     | |   |   |     ",
			"             | |               |     |     |                                         | |   |   |           | | | |   |     |     |                           |   |           | |   |     | |   |   |     ",
			"             | |               |     |     |                                         | |   |   |           | | | |   |     |     |                         +-----+           | |   |     | |   |   |     ",
			"             | |               |     |     |                                         | |   |   |           | | | |   |     |     |                         | |               | |   |     | |   |   |     ",
			"             | |               |     |     |           +-----------------------------|-----|---|--------S--|-|---|---------------|---------------------------|---------------+ | +-+     +-|-------+     ",
			"             | |               |     |     |           |                             | |   |   |           | | | |   |     |     |                         | |                 | |         |   |         ",
			"             | |               |     |     |           |                             | |   |   |           | +-------------+     +---------------------------+               +---+         |   |         ",
			"             | |               |     |     |           |                             | |   |   |           |   | |   |                                     |                 | |           |   |         ",
			"             | |               |     |     |         +-|-----------------------------|-----|---|-----------|-----|-------------------------------------------+     +---------|-|-----------------------+ ",
			"             | |               |     |     |         | |                             | |   |   |           |   | |   |                                     | |     |         B |           |   |       | ",
			"   +---------|-|---------------------|-----------------------------------------------|-+   | +-----------------------|---------------------------------------------|-----------------+     |   |       | ",
			"   |         | |               |     |     |         | |                             |     | | |           |   | |   |                                     | |     |         | |     |     |   |       | ",
			" Y +---------|-----------------------+     +-----------------------------------------+     +-|-------------|-----|---|---------------------------------------|-----|-----+ +-+ +-+   |     |   |       | ",
			" |           | |               |                     | |                                     | |           |   | |   |                                     | |     |     | |     |   |     |   |       | ",
			" |           | |               |   +-----------------+ +-------------------------------------+ |           |   +-+   +-------------------------------------|-|-------------|-----|-------+ |   |       | ",
			" |           | |               |   |                                                           |           |                                               | |     |     | |     |   |   | |   |       | ",
			" |       +---+ |               |   |                                                           +--------------------------------------------W----------------|-----|-----+ +-----+   +-----+   +-------+ ",
			" |       |     |               |   |                                                                       |                                               | |     |                     |               ",
			" +-------+     +---------------+   +-----------------------------------------------------------------------+                                               +-+     +---------------------+               ",
			"                                                                                                                                                                                                         "
	};


	private class Cell {
		final Grid grid;
		final String c;
		final int row;
		final int col;

		public Cell(Grid grid, String cell, int x, int y) {
			this.grid = grid;
			this.c = cell;
			this.row = x;
			this.col = y;
		}

		@Override
		public String toString() {
			return this.c;
		}

		public Cell nextCell(Cell previousCell) {
			Cell next = null;

			String curDir = this.c;
			if (previousCell != null) {
				if (this.isAlpha() ||
						("|".equals(curDir) && "-".equals(grid.previousDir)) ||
						("-".equals(curDir) && "|".equals(grid.previousDir))) {
					// Continu previous move
					curDir = grid.previousDir;
//					if (!"+".equals(previousDir)) {
//						curDir = previousDir;
//					} else {
//						// Compute dir
//						if (previousCell.col != this.col) {
//							curDir = "-";
//						} else {
//							curDir = "|";
//						}
//					}
				}
			}
			if ("|".equals(curDir)) {
				// Vertical cell, check top, bottom
				if (previousCell == null || previousCell.row < this.row) {
					// came from top
					if (this.row < this.grid.maxRow - 1) {
						Cell cell = this.grid.cells[this.row + 1][this.col];
						if (!cell.isEmpty()) {
							next = cell;
						}
					}
				} else if (previousCell.row > this.row) {
					// came from bottom
					if (this.row > 0) {
						Cell cell = this.grid.cells[this.row - 1][this.col];
						if (!cell.isEmpty()) {
							next = cell;
						}
					}
				} else {
					// Came from right or left
					// TODO possible ?
				}
				grid.previousDir = curDir;
			} else if ("-".equals(curDir)) {
				// Horizontal cell, check right then left
				if (previousCell.col < this.col) {
					// Came from left
					if (this.col < this.grid.maxCol - 1) {
						Cell cell = this.grid.cells[this.row][this.col + 1];
						if (!cell.isEmpty()) {
							next = cell;
						}
					}
				} else if (previousCell.col > this.col) {
					// Came from right
					if (this.col > 0) {
						Cell cell = this.grid.cells[this.row][this.col - 1];
						if (!cell.isEmpty()) {
							next = cell;
						}
					}
				} else {
					// Came from top or bottom
					// TODO possible ?
				}
				grid.previousDir = curDir;
			} else if ("+".equals(curDir)) {
				// Turn
				if ("|".equals(grid.previousDir)) {
					// Try right or left
					if (this.col < this.grid.maxCol - 1) {
						Cell cell = this.grid.cells[this.row][this.col + 1];
						if (!cell.isEmpty()) {
							next = cell;
						}
					}
					if (next == null && this.col > 0) {
						Cell cell = this.grid.cells[this.row][this.col - 1];
						if (!cell.isEmpty()) {
							next = cell;
						}
					}
					grid.previousDir = "-";
				} else if ("-".equals(grid.previousDir)) {
					// Try top or bottom
					if (this.row < this.grid.maxRow - 1) {
						Cell cell = this.grid.cells[this.row + 1][this.col];
						if (!cell.isEmpty()) {
							next = cell;
						}
					}
					if (next == null && this.row > 0) {
						Cell cell = this.grid.cells[this.row - 1][this.col];
						if (!cell.isEmpty()) {
							next = cell;
						}
					}
					grid.previousDir = "|";
				}
			}

			return next;
		}

		private boolean isEmpty() {
			return " ".equals(this.c);
		}

		public boolean isAlpha() {
			return this.c.matches("[A-Z]*");
		}
	}

	private class Grid {
		final int maxRow;
		final int maxCol;
		final Cell[][] cells;
		String previousDir = null;

		public Grid(int x, int y) {
			this.maxRow = x;
			this.maxCol = y;
			this.cells = new Cell[x][y];
		}

		@Override
		public String toString() {
			StringBuilder grid = new StringBuilder();
			for (int i = 0; i < maxRow; i++) {
				for (int j = 0; j < maxCol; j++) {
					grid.append(cells[i][j].toString());
				}
				grid.append("\n");
			}

			return grid.toString();
		}
	}

	Grid grid;

	private String program1(String... input) {
		Cell currentCell = null;
		grid = new Grid(input.length, input[0].length());
		for (int i = 0; i < input.length; i++) {
			String row = input[i];
			for (int j = 0; j < row.length(); j++) {
				String cell = row.substring(j, j + 1);

				grid.cells[i][j] = new Cell(grid, cell, i, j);
				if (i == 0 && "|".equals(cell)) {
					currentCell = grid.cells[i][j];
				}
			}
		}

		StringBuilder word = new StringBuilder();

		Cell previousCell = null;
		while (currentCell != null) {
			if (currentCell.isAlpha()) {
				word.append(currentCell.c);
			}

			Cell nextCell = currentCell.nextCell(previousCell);
			previousCell = currentCell;
			currentCell = nextCell;
		}

		return word.toString();
	}

	@Test
	public void example1_1() {
		String ret = program1(
				"     |          ",
				"     |  +--+    ",
				"     A  |  C    ",
				" F---|----E|--+ ",
				"     |  |  |  D ",
				"     +B-+  +--+ ");
		Assert.assertEquals("ABCDEF", ret);
	}

	@Test
	public void test1() {
		String ret = program1(INPUT);
		System.out.println("test1=" + ret);
	}

	private int program2(String... input) {
		Cell currentCell = null;
		grid = new Grid(input.length, input[0].length());
		for (int i = 0; i < input.length; i++) {
			String row = input[i];
			for (int j = 0; j < row.length(); j++) {
				String cell = row.substring(j, j + 1);

				grid.cells[i][j] = new Cell(grid, cell, i, j);
				if (i == 0 && "|".equals(cell)) {
					currentCell = grid.cells[i][j];
				}
			}
		}

		int step = 0;

		Cell previousCell = null;
		while (currentCell != null) {
			Cell nextCell = currentCell.nextCell(previousCell);
			previousCell = currentCell;
			currentCell = nextCell;
			step++;
		}

		return step;
	}

	@Test
	public void example2_1() {
		int ret = program2(
				"     |          ",
				"     |  +--+    ",
				"     A  |  C    ",
				" F---|----E|--+ ",
				"     |  |  |  D ",
				"     +B-+  +--+ ");
		Assert.assertEquals(38, ret);
	}

	@Test
	public void test2() {
		int ret = program2(INPUT);
		System.out.println("test2=" + ret);
	}
}
